# URL Shortener

A simple and robust URL shortening service built with Java and Spring Boot.

---

**Real World Examples:**
- Turn a long news article link like `https://www.nytimes.com/2025/06/01/technology/ai-news.html` into a short URL: `https://sho.rt/abc123`
- Share a Google Maps location: `https://www.google.com/maps/place/1600+Amphitheatre+Parkway,+Mountain+View,+CA` → `https://sho.rt/xyz789`
- Make event invites easier to share: `https://www.eventbrite.com/e/very-long-event-title-and-details-1234567890` → `https://sho.rt/evt456`

## Features
- Shorten a long URL to a unique, hash-based short URL (generated by the backend)
- Redirect users from a short URL to the original URL
- Collision detection and resolution for short URLs
- All timestamps are stored and returned in UTC

## Environment Setup

This project uses Java and Spring Boot. Follow these steps to set up your environment and run the application:

### Prerequisites
- **Java 17 or later**: Download and install from [AdoptOpenJDK](https://adoptium.net/) or [Oracle](https://www.oracle.com/java/technologies/downloads/).
- **Gradle**: This project uses the Gradle wrapper, so you do not need to install Gradle manually.
- **Git**: Download and install from [git-scm.com](https://git-scm.com/).
- **Docker & Docker Compose** (recommended for running PostgreSQL): Download and install from [docker.com](https://www.docker.com/).

### Steps
1. **Clone the repository:**
   ```sh
   git clone <repository-url>
   cd url-shortener
   ```
2. **Start PostgreSQL with Docker Compose (recommended):**
   ```sh
   docker compose up -d
   ```
   This will start a PostgreSQL container with the following credentials:
   - Database: `url-shortener`
   - Username: `my-user`
   - Password: `my-password`
   - Port: `5432`
3. **Build the project:**
   ```sh
   ./gradlew build
   ```
   On Windows, use `gradlew.bat build` instead.
4. **Run the application:**
   ```sh
   ./gradlew bootRun
   ```
   Or run the generated JAR file:
   ```sh
   java -jar build/libs/url-shortener-0.0.1-SNAPSHOT.war
   ```
5. **Access the application:**
   By default, the server runs at [http://localhost:8080](http://localhost:8080).
6. **Test the API:**
   - Shorten a URL:
     ```sh
     curl -X POST -H "Content-Type: application/json" \
       -d '{"originalUrl": "https://example.com"}' \
       http://localhost:8080/api/urls/shorten
     ```
   - Redirect to the original URL:
     ```sh
     curl -v http://localhost:8080/<short_code>
     ```
7. **Stop the Database:**
   ```sh
   docker compose down
   ```

### Notes
- Database data is persisted in a Docker-managed volume (`postgres_data`).
- The application will automatically run database migrations using Flyway on startup.
- You can change database credentials in `compose.yaml` and `application.yml` as needed.
- All timestamps are handled in UTC.

## API Endpoints

### Shorten a URL
- **POST** `/api/urls/shorten`
- **Request Body:**
  ```json
  {
    "originalUrl": "https://example.com"
  }
  ```
- **Response:**
  ```json
  {
    "id": "<uuid>",
    "shortUrl": "<short_code>",
    "originalUrl": "https://example.com",
    "createdAt": "2025-06-01T12:00:00Z"
  }
  ```

### Redirect to Original URL
- **GET** `/{shortUrl}`
- **Behavior:** Redirects (HTTP 302) to the original URL if found, otherwise returns 404.

## Non-Functional Improvements (Work in Progress)

- Implement caching for frequently accessed short URLs (e.g., using Redis)
- Optimize database queries and add proper indexing
- Collect and analyze usage statistics (e.g., count how many times each short URL is accessed)
